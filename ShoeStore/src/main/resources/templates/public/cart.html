<div
	th:replace="fragments/layout :: layout(content = ~{::content}, title='Giỏ hàng của bạn')">
	<div th:fragment="content">
		<h2 class="mb-4">
			<i class="fas fa-shopping-cart me-2"></i> Giỏ hàng của bạn
		</h2>

		<div th:if="${cart == null or cart.cartItems.empty}"
			class="alert alert-info text-center">
			Giỏ hàng của bạn đang trống. <a th:href="@{/products}">Bắt đầu
				mua sắm ngay!</a>
		</div>

		<div th:if="${cart != null and !cart.cartItems.empty}" class="row">
			<div class="col-md-8">
				<div class="card mb-3 shadow-sm" th:each="item : ${cart.cartItems}">
					<div class="card-body">
						<div class="row align-items-center">
							<div class="col-md-2">
								<img th:src="${item.product.imageUrl ?: 'placeholder.jpg'}"
									class="img-fluid rounded" alt="Product Image">
							</div>
							<div class="col-md-5">
								<h5 th:text="${item.product.name}">Tên Giày</h5>
								<p class="text-muted small">
									Mã SP: <span th:text="${item.product.productId}"></span>
								</p>
							</div>
							<div class="col-md-2">
								<form th:action="@{/cart/update}" method="post">
									<input type="hidden" name="productId"
										th:value="${item.product.productId}"> <input
										type="number" name="quantity" th:value="${item.quantity}"
										min="1" class="form-control form-control-sm text-center"
										style="width: 70px;" onchange="this.form.submit()">
								</form>
							</div>
							<div class="col-md-2 text-end">
								<span class="text-danger fw-bold"
									th:text="${#numbers.formatDecimal(item.product.price * item.quantity, 0, 'COMMA', 0, 'POINT') + ' VND'}">Đơn
									giá * SL</span>
							</div>
							<div class="col-md-1 text-end">
								<form th:action="@{/cart/remove}" method="post" class="d-inline">
									<input type="hidden" name="productId"
										th:value="${item.product.productId}">
									<button type="submit" class="btn btn-sm btn-outline-danger">
										<i class="fas fa-trash"></i>
									</button>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="col-md-4">
				<div class="card shadow-lg">
					<div class="card-header bg-primary text-white">Tóm tắt Đơn
						hàng</div>
					<div class="card-body">
						<h5 class="card-title mb-3">
							Tổng cộng: <span class="float-end text-danger"
								th:text="${#numbers.formatDecimal(cartTotal, 0, 'COMMA', 0, 'POINT') + ' VND'}">
								0 VND </span>
						</h5>

						<a th:href="@{/orders/checkout}"
							class="btn btn-success btn-lg w-100 mt-3"> <i
							class="fas fa-credit-card me-2"></i> Tiến hành Thanh toán
						</a>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>